this code is very old and very bad. some day if I have a spare moment I may make the code right, but for now it's enough that the code works (more or less). I know my priorities!
